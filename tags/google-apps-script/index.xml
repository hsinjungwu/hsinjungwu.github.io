<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Google Apps Script on FR4NK ä¹¾ä¸€æ¯ ğŸ»</title><link>https://hsinjungwu.github.io/tags/google-apps-script/</link><description>Recent content in Google Apps Script on FR4NK ä¹¾ä¸€æ¯ ğŸ»</description><generator>Hugo</generator><language>en</language><lastBuildDate>Wed, 18 Jan 2023 10:25:00 +0800</lastBuildDate><atom:link href="https://hsinjungwu.github.io/tags/google-apps-script/index.xml" rel="self" type="application/rss+xml"/><item><title>Build Your Own Custom Short URL</title><link>https://hsinjungwu.github.io/posts/build_your_own_custom_short_url/</link><pubDate>Wed, 18 Jan 2023 10:25:00 +0800</pubDate><guid>https://hsinjungwu.github.io/posts/build_your_own_custom_short_url/</guid><description>&lt;p>æœ€è¿‘åœ¨å¹«è€å©†åšå°å·¥å…·æ™‚çªç„¶çš„éˆæ„Ÿï¼Œå¯ä»¥é€é &lt;em>Line Bot&lt;/em> + &lt;em>Google Apps Script&lt;/em> + &lt;em>Github Issue&lt;/em> å®Œæˆå±¬æ–¼è‡ªå·±çš„çŸ­ç¶²å€æœå‹™ã€‚&lt;/p>
&lt;h2 id="å¯¦ä½œ">
 å¯¦ä½œ
 &lt;a class="heading-link" href="#%e5%af%a6%e4%bd%9c">
 &lt;i class="fa-solid fa-link" aria-hidden="true" title="Link to heading">&lt;/i>
 &lt;span class="sr-only">Link to heading&lt;/span>
 &lt;/a>
&lt;/h2>
&lt;h3 id="è¨­å®š-line-bot-è®€è¨Šæ¯">
 è¨­å®š Line Bot è®€è¨Šæ¯
 &lt;a class="heading-link" href="#%e8%a8%ad%e5%ae%9a-line-bot-%e8%ae%80%e8%a8%8a%e6%81%af">
 &lt;i class="fa-solid fa-link" aria-hidden="true" title="Link to heading">&lt;/i>
 &lt;span class="sr-only">Link to heading&lt;/span>
 &lt;/a>
&lt;/h3>
&lt;p>åƒè€ƒ &lt;a href="https://www.oxxostudio.tw/articles/201804/line-bot-apps-script.html" class="external-link" target="_blank" rel="noopener">å¯¦ä½œ LINE èŠå¤©æ©Ÿå™¨äºº ( Google Apps Script )&lt;/a> æˆ– &lt;a href="https://medium.com/%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/%E5%85%A9%E5%B0%8F%E6%99%82%E6%89%93%E9%80%A0%E7%B0%A1%E5%96%AE-line-chatbot-%E4%BD%BF%E7%94%A8-google-apps-script-google-sheet-api-8fff7372ff3d" class="external-link" target="_blank" rel="noopener">å…©å°æ™‚æ‰“é€ ç°¡å–® Line Chatbot â€” ä½¿ç”¨ Google Apps Script &amp;amp; Google Sheet API&lt;/a> å°±å¯ä»¥ã€‚&lt;/p>
&lt;div class="notice warning">
 &lt;div class="notice-title">
 &lt;i class="fa-solid fa-exclamation-triangle" aria-hidden="true">&lt;/i>Warning
 &lt;/div>
 &lt;div class="notice-content">è¨˜å¾—åœ¨ &lt;code>å›æ‡‰åŠŸèƒ½&lt;/code> ä¸­é—œæ‰ &lt;code>èŠå¤©&lt;/code> è·Ÿ &lt;code>è‡ªå‹•å›æ‡‰&lt;/code>ï¼Œä¸ç„¶ä½ çš„æ©Ÿå™¨äººä¸æœƒè‡ªå‹•å·²è®€ã€‚&lt;/div>
&lt;/div>

&lt;h3 id="ç”¢ç”ŸçŸ­ç¶²å€">
 ç”¢ç”ŸçŸ­ç¶²å€
 &lt;a class="heading-link" href="#%e7%94%a2%e7%94%9f%e7%9f%ad%e7%b6%b2%e5%9d%80">
 &lt;i class="fa-solid fa-link" aria-hidden="true" title="Link to heading">&lt;/i>
 &lt;span class="sr-only">Link to heading&lt;/span>
 &lt;/a>
&lt;/h3>
&lt;p>æƒ³æ³•ä¾†è‡ªæ–¼ç”¨ Github Issue å¯« Blogï¼Œå¯ä»¥ fork &lt;a href="https://github.com/casualjavascript/blog" class="external-link" target="_blank" rel="noopener">é€™ä»½å°ˆæ¡ˆ&lt;/a>ï¼Œå†åƒè€ƒ &lt;a href="https://stackoverflow.com/questions/5411538/redirect-from-an-html-page" class="external-link" target="_blank" rel="noopener">é€™ç¯‡&lt;/a> åœ¨ &lt;em>index.html&lt;/em> åŠ å…¥ä¸‹é¢é€™æ®µå³å¯ã€‚&lt;/p></description></item><item><title>ç”¨ Line ä¾†é€šçŸ¥ä¸Šä¸‹ç­æ‰“å¡ç´€éŒ„</title><link>https://hsinjungwu.github.io/posts/line_noftify_with_gas/</link><pubDate>Mon, 27 Sep 2021 10:20:00 +0800</pubDate><guid>https://hsinjungwu.github.io/posts/line_noftify_with_gas/</guid><description>&lt;p>å‰å¹¾å¤©å¿˜äº†è‡ªå·±ä¸‹ç­æœ‰æ²’æœ‰æ‰“å¡ï¼Œé™¤äº†å›å»è£œæ‰“ä¹‹å¤–ä¸ç„¶å°±æ˜¯è¦ç¶“éç¨®ç¨®é©—è­‰ç™»å…¥å…¬å¸ä¿¡ç®±æŸ¥è©¢ã€‚å¥—å¥ &lt;a href="https://blog.gslin.org/" class="external-link" target="_blank" rel="noopener">å¼·è€…æˆ‘å­¸é•·&lt;/a> èªªçš„ &lt;strong>å¹¹å£äº‹æ˜¯é€²æ­¥æœ€å¤§çš„åŸå‹•åŠ›&lt;/strong>ï¼Œæ–¼æ˜¯é–‹å§‹äº†é€™æ®µç°¡å–®æ—…ç¨‹ã€‚&lt;/p>
&lt;p>åŸæœ¬æƒ³ç”¨ &lt;a href="https://ifttt.com/home" class="external-link" target="_blank" rel="noopener">ifttt&lt;/a> ä¾†è™•ç†&lt;/p>
&lt;ol>
&lt;li>æ”¶åˆ°ä¿¡è‡ªå‹•è½‰å¯„çµ¦ ifttt&lt;/li>
&lt;li>ifttt é€çµ¦ Line Notify&lt;/li>
&lt;/ol>
&lt;p>ä½† gmail æ‡‰è©²æ˜¯é¿å…äº‚ç™¼éƒµä»¶ï¼Œæ‰€ä»¥è‡ªå‹•è½‰å¯„çš„æ”¶ä¿¡ä¿¡ç®±è¦èªè­‰ã€‚ä½†æˆ‘åˆæ²’è¾¦æ³•è·Ÿ ifttt æ‹¿èªè­‰ç¢¼ï¼Œæ‰€ä»¥é€™æ¢è·¯å°±ä¸è¡Œã€‚&lt;/p>
&lt;p>å¾Œä¾†æƒ³åˆ°æ›¾çœ‹éé€™ç¯‡ &lt;a href="https://www.letswrite.tw/line-notify-gas/" class="external-link" target="_blank" rel="noopener">LINE Notifyï¼šç”¨ Google Apps Script å»ºç«‹ç°¡æ˜“ç¶²ç«™ç›£æ¸¬æ©Ÿå™¨äºº&lt;/a>ï¼Œæ–¼æ˜¯å°±ç…§æŠ„ä»–é€é€šçŸ¥çš„ code å…¶ä»–å‰‡æ˜¯çœ‹ &lt;a href="https://developers.google.com/apps-script/reference/gmail" class="external-link" target="_blank" rel="noopener">å®˜æ–¹æ–‡ä»¶&lt;/a> çš„å…§å®¹æ‹¼æ¹Šã€‚&lt;/p>
&lt;p>è‡³æ–¼é‡åˆ°çš„å•é¡Œå¤§æ¦‚å°±æ˜¯åœ¨ &lt;code>GmailApp.search&lt;/code> çš„æ¢ä»¶ä¸çŸ¥é“æœ‰å“ªäº›é—œéµå­—ï¼Œä½†ç”Ÿå‘½æœƒè‡ªå·±æ‰¾åˆ°å‡ºè·¯ã€‚ç¸½ä¹‹ç¨‹å¼ç¢¼å¦‚ä¸‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd;font-style:italic">function&lt;/span> run() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd;font-style:italic">var&lt;/span> msg &lt;span style="color:#ff79c6">=&lt;/span> queryMail();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">if&lt;/span> (msg.length &lt;span style="color:#ff79c6">&amp;gt;&lt;/span> &lt;span style="color:#bd93f9">0&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lineMessage(msg);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd;font-style:italic">var&lt;/span> token &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;xxx&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd;font-style:italic">function&lt;/span> lineMessage(msg) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd;font-style:italic">var&lt;/span> option &lt;span style="color:#ff79c6">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> method&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;post&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> headers&lt;span style="color:#ff79c6">:&lt;/span> { Authorization&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;Bearer &amp;#34;&lt;/span> &lt;span style="color:#ff79c6">+&lt;/span> token },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> payload&lt;span style="color:#ff79c6">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> message&lt;span style="color:#ff79c6">:&lt;/span> msg,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> UrlFetchApp.fetch(&lt;span style="color:#f1fa8c">&amp;#34;https://notify-api.line.me/api/notify&amp;#34;&lt;/span>, option);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8be9fd;font-style:italic">function&lt;/span> queryMail() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd;font-style:italic">var&lt;/span> rtnMsg &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd;font-style:italic">var&lt;/span> condition &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#f1fa8c">&amp;#39;subject:&amp;#34;åˆ·å¡é€šçŸ¥&amp;#34; is:unread&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd;font-style:italic">var&lt;/span> threads &lt;span style="color:#ff79c6">=&lt;/span> GmailApp.search(condition);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd;font-style:italic">var&lt;/span> messages &lt;span style="color:#ff79c6">=&lt;/span> GmailApp.getMessagesForThreads(threads);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">for&lt;/span> (&lt;span style="color:#8be9fd;font-style:italic">var&lt;/span> i &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">0&lt;/span>; i &lt;span style="color:#ff79c6">&amp;lt;&lt;/span> messages.length; i&lt;span style="color:#ff79c6">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">for&lt;/span> (&lt;span style="color:#8be9fd;font-style:italic">var&lt;/span> j &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">0&lt;/span>; j &lt;span style="color:#ff79c6">&amp;lt;&lt;/span> messages[i].length; j&lt;span style="color:#ff79c6">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8be9fd;font-style:italic">var&lt;/span> mail &lt;span style="color:#ff79c6">=&lt;/span> messages[i][j];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">if&lt;/span> (mail.isUnread()) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> rtnMsg &lt;span style="color:#ff79c6">+=&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f1fa8c">&amp;#34;\n&amp;#34;&lt;/span> &lt;span style="color:#ff79c6">+&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Utilities.formatDate(mail.getDate(), &lt;span style="color:#f1fa8c">&amp;#34;GMT+8&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;yyyy/MM/dd&amp;#34;&lt;/span>) &lt;span style="color:#ff79c6">+&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f1fa8c">&amp;#34; &amp;#34;&lt;/span> &lt;span style="color:#ff79c6">+&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mail.getPlainBody();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mail.markRead();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">for&lt;/span> (&lt;span style="color:#8be9fd;font-style:italic">var&lt;/span> i &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">0&lt;/span>; i &lt;span style="color:#ff79c6">&amp;lt;&lt;/span> messages.length; i&lt;span style="color:#ff79c6">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> threads[i].moveToArchive();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ff79c6">return&lt;/span> rtnMsg;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>